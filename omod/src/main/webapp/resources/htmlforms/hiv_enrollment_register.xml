<htmlform>
    <!-- Autogenerated example form  (template from 01-Nov-2010 -->
    <macros>
        paperFormId = (Fill this in)
        headerColor =#2f1c55
        fontOnHeaderColor = white
    </macros>
    <style>
        .section {
        border: 1px solid $headerColor;
        padding: 2px;
        text-align: left;
        margin-bottom: 1em;
        }
        .sectionHeader {
        background-color: #2f1c55;
        color: white;
        /* display: block; */
        padding: 2px;
        font-weight: bold;
        }
        table tr:nth-child(even) {
        background: #ffffff;
        }
        .alnright{
        text-align: right;
        color:#000000;
        width: 25%;
        }
        .error{
        color:red;
        }
        .alnright_s{
        text-align: right;
        color:#000000;
        width: 13%;
        }
        .alnleft_s{
        text-align: left;
        color:#000000;
        width: 13%;
        }
        .alnleft{
        text-align: left;
        color:#000000;
        width: 25%;
        }
        td {
        border: none;
        }
        table th, table td {
        padding: 5px 10px;
        border: None;
        }
        .legend_style {
        max-width: 35%;
        background: #FAFAFA;
        <!--padding: 5px;-->
        margin: 0px left;
        box-shadow: 1px 1px 25px rgba(0,0,0,0.10);
        border-radius: 2px;
        border: 1px solid #305a72;
        border-bottom-left-radius: 2px;
        text-transform:initial;

        }
        form fieldset, .form fieldset {
        min-width: 98%;
        border: none;
        border-top: 1px solid #305a72;

        }
        table th, table td {
        padding: 5px 10px;
        /* border: 1px solid #DDD; */
        }
        table tr {
        border: None;
        }
        ul.select, .form input, .form select, .form textarea, .form ul.select {
        padding: 2px 10px;
        }
        form input, form select, form textarea, form ul.select, .form input, .form select, .form textarea, .form ul.select {
        padding: 2px 10px;
        }
        form select, .form select {
        max-width: 200px;
        min-width: 150px;
        }
        body {
        font-family: "OpenSans", Arial, sans-serif;
        color: #363463;
        font-size: 14px;
        }
        <!--table.baseline-aligned td {-->
        <!--vertical-align: baseline;-->
        <!--}-->
    </style>
    <script type="text/javascript">
        beforeSubmit.push(function() {
        var val_comfirmed = getValue('date_confirmed_hiv.value');
        var val_enrolled = getValue('date_enrolled.value');
        var var_art_start_date = getValue('art_start_date.value');
        if (val_comfirmed > val_enrolled) {
            getField('date_confirmed_hiv.error').html('Date enrolled has to be later than HIV confirmed date').show();
            return false;
        }
        if (var_art_start_date){
            if (val_comfirmed > var_art_start_date ){
            getField('art_start_date.error').html('ART start date has to be later than HIV confirmed date').show();
            return false;
            }
            if (val_enrolled > var_art_start_date ){
            getField('art_start_date.error').html('ART start date has to be later than HIV enrollment date').show();
            return false;
        }
        }

        return true;
        });
    </script>
    <div class="hidden" id="encounter-details" sectionTag="section" headerStyle="title" headerLabel="Encounter Details">
        <fieldset>
            <legend class="legend_style">When?</legend>
            <label>When?</label>
            <encounterDate default="now" showTime="false" allowFutureDates="false"/>
        </fieldset>

        <fieldset>
            <legend>Who?</legend>
            <label>Who?</label>
            <encounterProviderAndRole default="currentUser" encounterRole="240b26f9-dd88-4172-823d-4a8bfeb7841f"                                                     required="true"/>
        </fieldset>

        <fieldset>
            <legend>Where?</legend>
            <label>Where?</label>
            <encounterLocation default="SessionAttribute:emrContext.sessionLocationId"/>
        </fieldset>
    </div>

    <table style="margin-bottom: 20px;">
        <thead>
            <tr><th colspan='5' style="text-align: center">HIV Enrollment Form</th></tr>
        </thead>
    </table>
    <fieldset>
        <legend class="legend_style">Enrollment Details</legend>

        <table width="100%">
            <tr>
                <td class="alnleft_s" >Patient Unique ID/ART No </td>
                <td>
                    <patient default="" required="true" field="identifier" identifierTypeId='4'/>
                </td>

                <td class="alnleft_s" >Date Enrolled in Care</td>
                <td>
                    <enrollInProgram programId="1"  showDate="false"/>
                    <encounterDate id="date_enrolled"  showTime="false"/>
                </td>
                <td class="alnleft_s">Date Confirmed HIV+</td>
                <td class="alnleft_s"><obs id="date_confirmed_hiv" conceptId="160554"/></td>
            </tr>
            <tr>
                <td class="alnleft_s">Mode of HIV Test</td>
                <td class="alnleft_s"><obs conceptId="164947"/></td>
                <td class="alnleft_s">Care Entry Point</td>
                <td class="alnleft_s"><obs conceptId="160540"/></td>
                <td class="alnleft_s">Was patient transferred in from another facility</td>
                <td class="alnleft_s"> <p>
                    <obs id="whatKind" conceptId="160563" answerConceptIds="1066,1065,1067">
                        <controls>
                            <when value="1065" thenDisplay="#admit-section"/>
                        </controls>
                    </obs>
                </p>
                </td>
            </tr>
            <tr id="admit-section">
                <td class="alnleft_s">Facility transferred in from</td>
                <td class="alnleft_s"><obs conceptId="160535"/></td>
                <td class="alnleft_s">Date transferred in</td>
                <td class="alnleft_s"><obs conceptId="160534"/></td>
                <td  class="alnleft_s">Was patient previously on ART</td>
                <td class="alnleft_s">
                    <obs id="art_prev" style="yes_no_dropdown" conceptId="165766" >
                        <controls>
                            <when value="true" thenDisplay="#art_prev_result"/>
                        </controls>
                    </obs>
                </td>
            </tr>
            <tr id="art_prev_result">

                <td class="alnleft_s">Prior ART</td>
                <td class="alnleft_s"><obs conceptId="165242"/></td>
                <td  class="alnleft_s">ART Start Date</td>
                <td class="alnleft_s"><obs id="art_start_date" conceptId="159599"/></td>
            </tr>
        </table>
    </fieldset>
    <fieldset>
        <legend class="legend_style">Social Demography</legend>
        <table width="100%">
            <tr>
                <td class="alnleft_s" >Occupation</td>
                <td class="alnleft_s"><obs conceptId="1542"/></td>
                <td class="alnleft_s" >Marital Status</td>
                <td class="alnleft_s"><obs conceptId="1054"/></td>
                <td class="alnleft_s"></td>
                <td class="alnleft_s"></td>
            </tr>
        </table>
    </fieldset>
    <fieldset>
        <legend class="legend_style">Next of Kin Information</legend>
        <table width="100%">
            <tr>
                <td class="alnleft_s">Next of Kin</td>
                <td class="alnleft_s"><obs conceptId="162729"/></td>
                <td class="alnleft_s">Relationship with next of kin</td>
                <td class="alnleft_s"><obs conceptId="164943"/></td>
                <td class="alnleft_s">Phone number of next of Kin</td>
                <td class="alnleft_s"><obs conceptId="159635"/></td>
            </tr>
        </table>
    </fieldset>
    <fieldset>
        <legend class="legend_style">Signature</legend>
        <table width="100%">
            <tr>
                <td class="alnright_s">Visit Date:</td>
                <td class="alnleft_s">
                    <encounterDate default="now" showTime="false" allowFutureDates="false"/>
                </td>
                <td class="alnright_s">Enrolled by:</td>
                <td class="alnleft_s">
                    <encounterProvider />
                </td>
                <td class="alnright_s">Facility:</td>
                <td>
                    <encounterLocation default="SessionAttribute:emrContext.sessionLocationId"/>
                </td>
            </tr>
        </table>
    </fieldset>
    <submit/>
</htmlform>